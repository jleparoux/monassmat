<div class="modal-form">
  <div class="row">
    <div class="label">Date</div>
    <div class="value"><strong>{{ day }}</strong></div>
  </div>

  {% if saved %}
    <div class="notice notice--ok">Enregistre.</div>
  {% endif %}
  {% if deleted %}
    <div class="notice notice--ok">Supprime.</div>
  {% endif %}

  {% set labels = {
    "normal": "Journee de travail",
    "absence": "Absence",
    "unpaid_leave": "Conge sans solde",
    "holiday": "Jour ferie",
    "assmat_leave": "Conge assmat"
  } %}

  <form
    hx-post="/contracts/{{ contract_id }}/workdays"
    hx-target="#modalContent"
    hx-swap="innerHTML"
  >
    <input type="hidden" name="date" value="{{ day }}" />

    <label class="field">
      <span>Type de journee</span>
      <select name="kind" required>
        {% for k in kinds %}
          <option value="{{ k }}" {% if kind == k %}selected{% endif %}>{{ labels.get(k, k) }}</option>
        {% endfor %}
      </select>
    </label>

    <div class="field-group">
      <label class="field">
        <span>Heure de depose</span>
        <input name="start_time" type="time" value="{{ start_time }}" />
      </label>
      <label class="field">
        <span>Heure de reprise</span>
        <input name="end_time" type="time" value="{{ end_time }}" />
      </label>
    </div>

    <div class="field check-group">
      <label class="checkbox">
        <input name="fee_meal" type="checkbox" {% if fee_meal %}checked{% endif %} />
        <span>Frais de repas</span>
      </label>
      <label class="checkbox">
        <input name="fee_maintenance" type="checkbox" {% if fee_maintenance %}checked{% endif %} />
        <span>Frais d'entretien</span>
      </label>
    </div>

    <div class="preview">
      <div class="preview__label">Apercu</div>
      <div class="preview__value" id="dayPreviewValue">
        {% if start_time and end_time %}
          {{ start_time }} - {{ end_time }}
        {% else %}
          {{ hours or 0 }} h
        {% endif %}
      </div>
    </div>

    <div class="actions">
      {% if has_entry %}
        <button
          class="btn btn-secondary"
          type="button"
          hx-post="/contracts/{{ contract_id }}/workdays/delete"
          hx-include="closest form"
          hx-target="#modalContent"
          hx-swap="innerHTML"
          hx-confirm="Supprimer la saisie de ce jour ?"
        >
          Supprimer
        </button>
      {% endif %}
      <button class="btn btn-secondary" type="button" data-close="true">Annuler</button>
      <button class="btn btn-primary" type="submit">Sauvegarder</button>
    </div>
  </form>
</div>
